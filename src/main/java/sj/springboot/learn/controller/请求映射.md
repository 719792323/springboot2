# URL隐射到具体方法的原理
请求映射的类关系主要涉及四个类
HttpServlet<-HttpServletBean<-FrameworkServlet<-DispatcherServlet(右边继承左边)
假设以一个get请求为例:
调用过程是:doGet(HttpServlet定义的方法,FrameworkServlet中实现)->doService(FrameworkServlet的实现)>doDispatch(DispatcherServlet的实现)
最核心的方法是DispatcherServlet中的doDispatch,所有URL请求都会调用此方法进行路由映射
```text
protected void doDispatch(HttpServletRequest request, HttpServletResponse response) throws Exception {}
```
1. 找能处理的handler
doDispatch根据下面的代码查找该Request的URL信息,是否有对应能处理的handler(也就是对应controller中隐射到的方法)
```text
 mappedHandler = this.getHandler(processedRequest);
 if (mappedHandler == null) {
     this.noHandlerFound(processedRequest, response);
     return;
 }
```
2. 执行:前钩子->handler->后钩子
```text
      //前钩子
      if (!mappedHandler.applyPreHandle(processedRequest, response)) {
                          return;
      }
      //handler
      mv = ha.handle(processedRequest, response, mappedHandler.getHandler());
      if (asyncManager.isConcurrentHandlingStarted()) {
          return;
      }
      //后钩子
      this.applyDefaultViewName(processedRequest, mv);
      mappedHandler.applyPostHandle(processedRequest, response, mv);
```

# 参数映射注解
## @PathVariable
路径变量用法很简单结合URL即可,如果下面既可以获得id
```text
    @GetMapping("/test/{id}")
    public String test(@PathVariable("id") Integer id,//某个
      @PathVariable Map<String,String> pv //全部
    )
```
## @RequestParam
获取url中?或者body中的KV参数
```text
    假设请求是/test?id=1
    @GetMapping("/test")
    public String test(@RequestParam("age") Integer id
     @RequestParam Map<String,String> params
    )
```
## @CookieValue
获取cookie中的KV参数和@RequestParam用法类似
```text
    @GetMapping("/test")
    public String test(@CookieValue("_ga") String _ga
     @CookieValue("_ga") Cookie cookie//返回cookie对象
     //应该也支持全部写法
    )
```
## @RequestHeader
获取HEADER中的KV参数
```text
    @GetMapping("/test")
    public String test(@RequestHeader("User-Agent") String userAgent,//获取某个值
                       @RequestHeader Map<String,String> header //获取全部)
```
## @RequestBody
获得POST请求中的body数据
```text
    @GetMapping("/test")
    public String test(@RequestBody String content)
```
## @MatrixVariable
矩阵请求写法
```text
    //1、语法： 请求路径：/cars/sell;low=34;brand=byd,audi,yd
    //2、SpringBoot默认是禁用了矩阵变量的功能
    // 手动开启：原理。对于路径的处理。UrlPathHelper进行解析。
    //removeSemicolonContent（移除分号内容）支持矩阵变量的
    //3、矩阵变量必须有url路径变量才能被解析
    @GetMapping("/cars/{path}")
    public Map carsSell(@MatrixVariable("low") Integer low,
                        @MatrixVariable("brand") List<String> brand,
                        @PathVariable("path") String path){
        Map<String,Object> map = new HashMap<>();

        map.put("low",low);
        map.put("brand",brand);
        map.put("path",path);
        return map;
    }
```
## @ModelAttribute
